{"version":3,"file":"js/492.a2c11e3d.js","mappings":"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","sources":["webpack://vue_login/./src/components/power/Roles.vue","webpack://vue_login/src/components/power/Roles.vue","webpack://vue_login/./src/components/power/Roles.vue?fd0e","webpack://vue_login/./src/components/power/Roles.vue?a0df"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/home' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"权限管理\")]),_c('el-breadcrumb-item',[_vm._v(\"角色列表\")])],1),_c('el-card',[_c('el-row',[_c('el-col',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.AddRoleDialogVisible=true}}},[_vm._v(\"添加角色\")])],1)],1),_c('el-table',{attrs:{\"data\":_vm.rolesList,\"border\":\"\",\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return _vm._l((scope.row.children),function(item1,i1){return _c('el-row',{key:item1.id,class:['bdbottom', i1 === 0 ? 'bdtop' : '', 'vcenter']},[_c('el-col',{attrs:{\"span\":5}},[_c('el-tag',{attrs:{\"closable\":\"\"},on:{\"close\":function($event){return _vm.removeRightById(scope.row, item1.id)}}},[_vm._v(_vm._s(item1.authName))]),_c('i',{staticClass:\"el-icon-caret-right\"})],1),_c('el-col',{attrs:{\"span\":19}},_vm._l((item1.children),function(item2,i2){return _c('el-row',{key:item2.id,class:[i2 === 0 ? '' : 'bdtop', 'vcenter']},[_c('el-col',{attrs:{\"span\":6}},[_c('el-tag',{attrs:{\"type\":\"success\",\"closable\":\"\"},on:{\"close\":function($event){return _vm.removeRightById(scope.row, item2.id)}}},[_vm._v(_vm._s(item2.authName))]),_c('i',{staticClass:\"el-icon-caret-right\"})],1),_c('el-col',{attrs:{\"span\":18}},_vm._l((item2.children),function(item3){return _c('el-tag',{key:item3.id,attrs:{\"type\":\"warning\",\"closable\":\"\"},on:{\"close\":function($event){return _vm.removeRightById(scope.row, item3.id)}}},[_vm._v(_vm._s(item3.authName))])}),1)],1)}),1)],1)})}}])}),_c('el-table-column',{attrs:{\"type\":\"index\",\"label\":\"#\"}}),_c('el-table-column',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}}),_c('el-table-column',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"300px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-edit\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.showEditDialog(scope.row.id)}}},[_vm._v(\"编辑\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.removeRoleById(scope.row.id)}}},[_vm._v(\"删除\")]),_c('el-button',{attrs:{\"type\":\"warning\",\"icon\":\"el-icon-setting\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.showSetRightDialog(scope.row)}}},[_vm._v(\"分配权限\")])]}}])})],1)],1),_c('el-dialog',{attrs:{\"title\":\"分配权限\",\"visible\":_vm.setRightDialogVisible,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.setRightDialogVisible=$event},\"close\":_vm.setRightDialogClosed}},[_c('el-tree',{ref:\"treeRef\",attrs:{\"data\":_vm.rightsList,\"props\":_vm.treeProps,\"show-checkbox\":\"\",\"node-key\":\"id\",\"default-expand-all\":\"\",\"default-checked-keys\":_vm.defKeys}}),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.setRightDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.allotRights}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"添加角色\",\"visible\":_vm.AddRoleDialogVisible,\"width\":\"40%\"},on:{\"update:visible\":function($event){_vm.AddRoleDialogVisible=$event},\"close\":_vm.addRoleDialogClosed}},[_c('el-form',{ref:\"addRoleFormRef\",attrs:{\"model\":_vm.addRoleForm,\"rules\":_vm.addRoleFormRules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}},[_c('el-input',{model:{value:(_vm.addRoleForm.roleName),callback:function ($$v) {_vm.$set(_vm.addRoleForm, \"roleName\", $$v)},expression:\"addRoleForm.roleName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}},[_c('el-input',{model:{value:(_vm.addRoleForm.roleDesc),callback:function ($$v) {_vm.$set(_vm.addRoleForm, \"roleDesc\", $$v)},expression:\"addRoleForm.roleDesc\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.AddRoleDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addRoles}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"编辑角色\",\"visible\":_vm.editRoleDialogVisible,\"width\":\"40%\"},on:{\"update:visible\":function($event){_vm.editRoleDialogVisible=$event},\"close\":_vm.addRoleDialogClosed}},[_c('el-form',{ref:\"editRoleFormRef\",attrs:{\"model\":_vm.editRoleForm,\"rules\":_vm.editRoleFormRules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}},[_c('el-input',{model:{value:(_vm.editRoleForm.roleName),callback:function ($$v) {_vm.$set(_vm.editRoleForm, \"roleName\", $$v)},expression:\"editRoleForm.roleName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"角色描述\",\"prop\":\"roleDesc\"}},[_c('el-input',{model:{value:(_vm.editRoleForm.roleDesc),callback:function ($$v) {_vm.$set(_vm.editRoleForm, \"roleDesc\", $$v)},expression:\"editRoleForm.roleDesc\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.editRoleDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editRoles}},[_vm._v(\"确 定\")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <!-- 面包屑导航区 -->\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>权限管理</el-breadcrumb-item>\n      <el-breadcrumb-item>角色列表</el-breadcrumb-item>\n    </el-breadcrumb>\n    <!-- 卡片视图 -->\n    <el-card>\n      <!-- 添加角色按钮 -->\n      <el-row>\n        <el-col>\n          <el-button type=\"primary\" @click=\"AddRoleDialogVisible=true\">添加角色</el-button>\n        </el-col>\n      </el-row>\n      <!-- 角色列表 -->\n      <el-table :data=\"rolesList\" border stripe>\n        <!-- 展开列 -->\n        <el-table-column type=\"expand\">\n          <template slot-scope=\"scope\">\n            <el-row\n              :class=\"['bdbottom', i1 === 0 ? 'bdtop' : '', 'vcenter']\"\n              v-for=\"(item1, i1) in scope.row.children\"\n              :key=\"item1.id\"\n            >\n              <!-- 一级权限 -->\n              <el-col :span=\"5\">\n                <el-tag closable @close=\"removeRightById(scope.row, item1.id)\">{{ item1.authName}}</el-tag>\n                <i class=\"el-icon-caret-right\"></i>\n              </el-col>\n              <!-- 二级和三级 -->\n              <el-col :span=\"19\">\n                <!-- 通过for循环 渲染二级权限 -->\n                <el-row\n                  :class=\"[i2 === 0 ? '' : 'bdtop', 'vcenter']\"\n                  v-for=\"(item2, i2) in item1.children\"\n                  :key=\"item2.id\"\n                >\n                  <el-col :span=\"6 \">\n                    <el-tag\n                      type=\"success\"\n                      closable\n                      @close=\"removeRightById(scope.row, item2.id)\"\n                    >{{ item2.authName }}</el-tag>\n                    <i class=\"el-icon-caret-right\"></i>\n                  </el-col>\n                  <el-col :span=\"18\">\n                    <el-tag\n                      type=\"warning\"\n                      v-for=\"(item3) in item2.children\"\n                      :key=\"item3.id\"\n                      closable\n                      @close=\"removeRightById(scope.row, item3.id)\"\n                    >{{ item3.authName}}</el-tag>\n                  </el-col>\n                </el-row>\n              </el-col>\n            </el-row>\n          </template>\n        </el-table-column>\n        <!-- 索引列 -->\n        <el-table-column type=\"index\" label=\"#\"></el-table-column>\n        <el-table-column label=\"角色名称\" prop=\"roleName\"></el-table-column>\n        <el-table-column label=\"角色描述\" prop=\"roleDesc\"></el-table-column>\n        <el-table-column label=\"操作\" width=\"300px\">\n          <template slot-scope=\"scope\">\n            <el-button type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" @click=\"showEditDialog(scope.row.id)\">编辑</el-button>\n            <el-button type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" @click=\"removeRoleById(scope.row.id)\">删除</el-button>\n            <el-button\n              type=\"warning\"\n              icon=\"el-icon-setting\"\n              size=\"mini\"\n              @click=\"showSetRightDialog(scope.row)\"\n            >分配权限</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n    </el-card>\n    <!-- 分配权限 -->\n    <el-dialog\n      title=\"分配权限\"\n      :visible.sync=\"setRightDialogVisible\"\n      width=\"50%\"\n      @close=\"setRightDialogClosed\"\n    >\n      <el-tree\n        :data=\"rightsList\"\n        :props=\"treeProps\"\n        ref=\"treeRef\"\n        show-checkbox\n        node-key=\"id\"\n        default-expand-all\n        :default-checked-keys=\"defKeys\"\n      ></el-tree>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"setRightDialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"allotRights\">确 定</el-button>\n      </span>\n    </el-dialog>\n    <!-- 添加角色对话框 -->\n    <el-dialog title=\"添加角色\" :visible.sync=\"AddRoleDialogVisible\" width=\"40%\" @close=\"addRoleDialogClosed\">\n      <el-form\n        :model=\"addRoleForm\"\n        ref=\"addRoleFormRef\"\n        :rules=\"addRoleFormRules\"\n        label-width=\"100px\"\n      >\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\n          <el-input v-model=\"addRoleForm.roleName\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"角色描述\" prop=\"roleDesc\">\n          <el-input v-model=\"addRoleForm.roleDesc\"></el-input>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"AddRoleDialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addRoles\">确 定</el-button>\n      </span>\n    </el-dialog>\n    <!-- 编辑角色对话框 -->\n    <el-dialog title=\"编辑角色\" :visible.sync=\"editRoleDialogVisible\" width=\"40%\" @close=\"addRoleDialogClosed\">\n      <el-form\n        :model=\"editRoleForm\"\n        ref=\"editRoleFormRef\"\n        :rules=\"editRoleFormRules\"\n        label-width=\"100px\"\n      >\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\n          <el-input v-model=\"editRoleForm.roleName\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"角色描述\" prop=\"roleDesc\">\n          <el-input v-model=\"editRoleForm.roleDesc\"></el-input>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"editRoleDialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"editRoles\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  data () {\n    return {\n      // 所有角色列表\n      rolesList: [],\n      // 分配权限框\n      setRightDialogVisible: false,\n      // 权限列表\n      rightsList: [],\n      //  树形控件的属性绑定对象\n      treeProps: {\n        label: 'authName',\n        children: 'children'\n      },\n      //   默认选中节点ID值\n      defKeys: [],\n      //   添加用户对话框\n      AddRoleDialogVisible: false,\n      // 添加角色表单\n      addRoleForm: {},\n      //   添加角色表单验证\n      addRoleFormRules: {\n        roleName: [\n          { required: true, message: '请输入角色名称', trigger: 'blur' }\n        ],\n        roleDesc: [\n          { required: true, message: '请输入角色描述', trigger: 'blur' }\n        ]\n      },\n      //   编辑角色信息\n      editRoleForm: {},\n      editRoleDialogVisible: false,\n      editRoleFormRules: {\n        roleName: [\n          { required: true, message: '请输入角色名称', trigger: 'blur' }\n        ],\n        roleDesc: [\n          { required: true, message: '请输入角色描述', trigger: 'blur' }\n        ]\n      },\n      //   当前即将分配权限的Id\n      roleId: 0\n    }\n  },\n  created () {\n    this.getRolesList()\n  },\n  methods: {\n    async getRolesList () {\n      const { data: res } = await this.$http.get('roles')\n      if (res.meta.status !== 200) {\n        return this.$message.error('获取角色列表失败！')\n      }\n      this.rolesList = res.data\n    },\n    // 根据ID删除对应的权限\n    async removeRightById (role, rightId) {\n      // 弹框提示 删除\n      const confirmResult = await this.$confirm(\n        '此操作将永久删除该权限, 是否继续?',\n        '提示',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).catch(err => err)\n      // 点击确定 返回值为：confirm\n      // 点击取消 返回值为： cancel\n      if (confirmResult !== 'confirm') {\n        return this.$message.info('已取消权限删除')\n      }\n      const { data: res } = await this.$http.delete(\n        `roles/${role.id}/rights/${rightId}`\n      )\n      if (res.meta.status !== 200) {\n        return this.$message.error('删除权限失败！')\n      }\n      role.children = res.data\n      //   不建议使用\n      // this.getRolesList()\n    },\n    // 分配权限\n    async showSetRightDialog (role) {\n      this.roleId = role.id\n      // 获取角色的所有权限\n      const { data: res } = await this.$http.get('rights/tree')\n      if (res.meta.status !== 200) {\n        return this.$message.error('获取权限数据失败！')\n      }\n      //   获取权限树\n      this.rightsList = res.data\n      //   console.log(res)\n      //   递归获取三级节点的id\n      this.getLeafkeys(role, this.defKeys)\n\n      this.setRightDialogVisible = true\n    },\n    // 通过递归 获取角色下三级权限的 id, 并保存到defKeys数组\n    getLeafkeys (node, arr) {\n      // 没有children属性，则是三级节点\n      if (!node.children) {\n        return arr.push(node.id)\n      }\n      node.children.forEach(item => this.getLeafkeys(item, arr))\n    },\n    // 权限对话框关闭事件\n    setRightDialogClosed () {\n      this.defKeys = []\n    },\n    // 添加角色对话框的关闭\n    addRoleDialogClosed () {\n      this.$refs.addRoleFormRef.resetFields()\n    },\n    // 添加角色\n    addRoles () {\n      this.$refs.addRoleFormRef.validate(async valid => {\n        if (!valid) return\n        const { data: res } = await this.$http.post('roles', this.addRoleForm)\n        if (res.meta.status !== 201) {\n          this.$message.error('添加角色失败！')\n        }\n        this.$message.success('添加角色成功！')\n        this.AddRoleDialogVisible = false\n        this.getRolesList()\n      })\n    },\n    // 删除角色\n    async removeRoleById (id) {\n      const confirmResult = await this.$confirm(\n        '此操作将永久删除该角色, 是否继续?',\n        '提示',\n        {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }\n      ).catch(err => err)\n      if (confirmResult !== 'confirm') {\n        return this.$message.info('已取消删除')\n      }\n      const { data: res } = await this.$http.delete('roles/' + id)\n      if (res.meta.status !== 200) return this.$message.error('删除角色失败！')\n      this.$message.success('删除用户成功！')\n      this.getRolesList()\n    },\n    // 编辑角色\n    async showEditDialog (id) {\n      const { data: res } = await this.$http.get('roles/' + id)\n      if (res.meta.status !== 200) return this.$message.error('查询角色信息失败！')\n      this.editRoleForm = res.data\n      this.editRoleDialogVisible = true\n    },\n    editRoles () {\n      this.$refs.editRoleFormRef.validate(async valid => {\n        // console.log(valid)\n        // 表单预校验失败\n        if (!valid) return\n        const { data: res } = await this.$http.put(\n          'roles/' + this.editRoleForm.roleId,\n          {\n            roleName: this.editRoleForm.roleName,\n            roleDesc: this.editRoleForm.roleDesc\n          }\n        )\n        if (res.meta.status !== 200) {\n          this.$message.error('更新角色信息失败！')\n        }\n        // 隐藏编辑角色对话框\n        this.editRoleDialogVisible = false\n        this.$message.success('更新角色信息成功！')\n        this.getRolesList()\n      })\n    },\n    // 分配权限\n    async allotRights (roleId) {\n      // 获得当前选中和半选中的Id\n      const keys = [\n        ...this.$refs.treeRef.getCheckedKeys(),\n        ...this.$refs.treeRef.getHalfCheckedKeys()\n      ]\n      // join() 方法用于把数组中的所有元素放入一个字符串\n      const idStr = keys.join(',')\n      const { data: res } = await this.$http.post(`roles/${this.roleId}/rights`, { rids: idStr })\n      if (res.meta.status !== 200) { return this.$message.error('分配权限失败！') }\n      this.$message.success('分配权限成功!')\n      this.getRolesList()\n      this.setRightDialogVisible = false\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.el-tag {\n  margin: 7px;\n}\n.bdtop {\n  border-top: 1px solid #eee;\n}\n.bdbottom {\n  border-bottom: 1px solid #eee;\n}\n.vcenter {\n  display: flex;\n  align-items: center;\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Roles.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Roles.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Roles.vue?vue&type=template&id=58b032eb&scoped=true&\"\nimport script from \"./Roles.vue?vue&type=script&lang=js&\"\nexport * from \"./Roles.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Roles.vue?vue&type=style&index=0&id=58b032eb&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"58b032eb\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","path","_v","on","$event","AddRoleDialogVisible","rolesList","scopedSlots","_u","key","fn","scope","_l","row","children","item1","i1","id","class","removeRightById","_s","authName","staticClass","item2","i2","item3","showEditDialog","removeRoleById","showSetRightDialog","setRightDialogVisible","setRightDialogClosed","ref","rightsList","treeProps","defKeys","slot","allotRights","addRoleDialogClosed","addRoleForm","addRoleFormRules","model","value","roleName","callback","$$v","$set","expression","roleDesc","addRoles","editRoleDialogVisible","editRoleForm","editRoleFormRules","editRoles","staticRenderFns","data","label","required","message","trigger","roleId","created","getRolesList","methods","res","$http","get","meta","status","$message","error","role","rightId","confirmResult","$confirm","confirmButtonText","cancelButtonText","type","catch","err","info","delete","getLeafkeys","node","arr","push","forEach","item","$refs","addRoleFormRef","resetFields","validate","valid","post","success","editRoleFormRef","put","keys","treeRef","getCheckedKeys","getHalfCheckedKeys","idStr","join","rids","component"],"sourceRoot":""}